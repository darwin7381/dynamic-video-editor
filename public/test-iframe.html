<!DOCTYPE html>
<html>
<head>
  <title>iframe ä»£ç†æ¸¬è©¦</title>
  <style>
    body { margin: 20px; font-family: sans-serif; }
    .test-section { margin: 20px 0; padding: 20px; border: 2px solid #ccc; }
    h2 { color: #333; }
    img, video { max-width: 100%; height: auto; }
    .result { margin-top: 10px; padding: 10px; background: #f0f0f0; }
  </style>
</head>
<body>
  <h1>ğŸ§ª iframe ç›¸å°è·¯å¾‘ä»£ç†æ¸¬è©¦</h1>
  
  <div class="test-section">
    <h2>æ¸¬è©¦ 1ï¼šç›´æ¥åœ¨ä¸»é é¢è¼‰å…¥ä»£ç† URL</h2>
    <img src="/api/media-proxy?url=https%3A%2F%2Ffiles.blocktempo.ai%2FBlockTempo_Daily_v1.5%2Fnews_image.jpeg" alt="ä»£ç†åœ–ç‰‡">
    <div class="result" id="test1-result">è¼‰å…¥ä¸­...</div>
  </div>
  
  <div class="test-section">
    <h2>æ¸¬è©¦ 2ï¼šåœ¨ iframe ä¸­è¼‰å…¥ä»£ç† URL</h2>
    <iframe id="test-iframe" width="800" height="600" style="border: 1px solid #999;"></iframe>
    <div class="result" id="test2-result">è¼‰å…¥ä¸­...</div>
  </div>
  
  <div class="test-section">
    <h2>æ¸¬è©¦ 3ï¼šiframe å¾ä¸åŒæºè¼‰å…¥é é¢å¾Œè«‹æ±‚ä»£ç†</h2>
    <p>é€™å€‹æ¸¬è©¦æ¨¡æ“¬ Creatomate iframe çš„æƒ…æ³</p>
    <div class="result" id="test3-result">
      âŒ ç„¡æ³•æ¸¬è©¦ - éœ€è¦çœŸå¯¦çš„è·¨åŸŸ iframe ç’°å¢ƒ
    </div>
  </div>

  <script>
    // æ¸¬è©¦ 1ï¼šä¸»é é¢åœ–ç‰‡è¼‰å…¥
    const img1 = document.querySelector('.test-section:nth-child(2) img');
    img1.onload = () => {
      document.getElementById('test1-result').textContent = 'âœ… ä¸»é é¢è¼‰å…¥æˆåŠŸ';
      document.getElementById('test1-result').style.background = '#d4edda';
      document.getElementById('test1-result').style.color = '#155724';
    };
    img1.onerror = () => {
      document.getElementById('test1-result').textContent = 'âŒ ä¸»é é¢è¼‰å…¥å¤±æ•—';
      document.getElementById('test1-result').style.background = '#f8d7da';
      document.getElementById('test1-result').style.color = '#721c24';
    };
    
    // æ¸¬è©¦ 2ï¼šiframe å…§è¼‰å…¥
    const testIframe = document.getElementById('test-iframe');
    const iframeHTML = `
      <!DOCTYPE html>
      <html>
      <head>
        <style>
          body { margin: 0; display: flex; justify-content: center; align-items: center; height: 100vh; background: #f0f0f0; }
          img { max-width: 100%; max-height: 100%; }
        </style>
      </head>
      <body>
        <img src="/api/media-proxy?url=https%3A%2F%2Ffiles.blocktempo.ai%2FBlockTempo_Daily_v1.5%2Fnews_image.jpeg" alt="iframeå…§çš„ä»£ç†åœ–ç‰‡">
        <script>
          const img = document.querySelector('img');
          img.onload = () => {
            window.parent.postMessage({ test: 'iframe-img-loaded', success: true }, '*');
          };
          img.onerror = (e) => {
            window.parent.postMessage({ test: 'iframe-img-loaded', success: false, error: e }, '*');
          };
        <\/script>
      </body>
      </html>
    `;
    
    testIframe.srcdoc = iframeHTML;
    
    // ç›£è½ iframe çš„è¨Šæ¯
    window.addEventListener('message', (e) => {
      if (e.data.test === 'iframe-img-loaded') {
        const result = document.getElementById('test2-result');
        if (e.data.success) {
          result.textContent = 'âœ… iframe å…§è¼‰å…¥æˆåŠŸï¼ˆåŒæº iframeï¼‰';
          result.style.background = '#d4edda';
          result.style.color = '#155724';
        } else {
          result.textContent = 'âŒ iframe å…§è¼‰å…¥å¤±æ•—';
          result.style.background = '#f8d7da';
          result.style.color = '#721c24';
        }
      }
    });
  </script>
</body>
</html>

